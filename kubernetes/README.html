
<!DOCTYPE html>

<html>
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1.0" />
    <title>Kubernetes &#8212; Juniper Documentation</title>
    
  <link href="../_static/css/theme.css" rel="stylesheet" />
  <link href="../_static/css/index.c5995385ac14fb8791e8eb36b4908be2.css" rel="stylesheet" />

    
  <link rel="stylesheet"
    href="../_static/vendor/fontawesome/5.13.0/css/all.min.css">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-solid-900.woff2">
  <link rel="preload" as="font" type="font/woff2" crossorigin
    href="../_static/vendor/fontawesome/5.13.0/webfonts/fa-brands-400.woff2">

    
      

    
    <link rel="stylesheet" type="text/css" href="../_static/pygments.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-book-theme.css?digest=c3fdc42140077d1ad13ad2f1588a4309" />
    <link rel="stylesheet" type="text/css" href="../_static/togglebutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/copybutton.css" />
    <link rel="stylesheet" type="text/css" href="../_static/mystnb.css" />
    <link rel="stylesheet" type="text/css" href="../_static/sphinx-thebe.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-main.c949a650a448cc0ae9fd3441c0e17fb0.css" />
    <link rel="stylesheet" type="text/css" href="../_static/panels-variables.06eb56fa6e07937060861dad626602ad.css" />
    
  <link rel="preload" as="script" href="../_static/js/index.1c5a1a01449ed65a7b51.js">

    <script data-url_root="../" id="documentation_options" src="../_static/documentation_options.js"></script>
    <script src="../_static/jquery.js"></script>
    <script src="../_static/underscore.js"></script>
    <script src="../_static/doctools.js"></script>
    <script src="../_static/togglebutton.js"></script>
    <script src="../_static/clipboard.min.js"></script>
    <script src="../_static/copybutton.js"></script>
    <script>var togglebuttonSelector = '.toggle, .admonition.dropdown, .tag_hide_input div.cell_input, .tag_hide-input div.cell_input, .tag_hide_output div.cell_output, .tag_hide-output div.cell_output, .tag_hide_cell.cell, .tag_hide-cell.cell';</script>
    <script src="../_static/sphinx-book-theme.12a9622fbb08dcb3a2a40b2c02b83a57.js"></script>
    <script async="async" src="https://unpkg.com/thebe@0.5.1/lib/index.js"></script>
    <script>
        const thebe_selector = ".thebe"
        const thebe_selector_input = "pre"
        const thebe_selector_output = ".output"
    </script>
    <script async="async" src="../_static/sphinx-thebe.js"></script>
    <link rel="index" title="Index" href="../genindex.html" />
    <link rel="search" title="Search" href="../search.html" />
    <link rel="next" title="Services" href="../services/overview.html" />
    <link rel="prev" title="Views" href="../datasets/views.html" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
    <meta name="docsearch:language" content="en" />
    
  </head>
  <body data-spy="scroll" data-target="#bd-toc-nav" data-offset="80">
    
    <div class="container-fluid" id="banner"></div>

    

    <div class="container-xl">
      <div class="row">
          
<div class="col-12 col-md-3 bd-sidebar site-navigation show" id="site-navigation">
    
        <div class="navbar-brand-box">
    <a class="navbar-brand text-wrap" href="../index.html">
      
      
      
      <h1 class="site-logo" id="site-title">Juniper Documentation</h1>
      
    </a>
</div><form class="bd-search d-flex align-items-center" action="../search.html" method="get">
  <i class="icon fas fa-search"></i>
  <input type="search" class="form-control" name="q" id="search-input" placeholder="Search this book..." aria-label="Search this book..." autocomplete="off" >
</form><nav class="bd-links" id="bd-docs-nav" aria-label="Main">
    <div class="bd-toc-item active">
        <ul class="nav bd-sidenav">
 <li class="toctree-l1">
  <a class="reference internal" href="../intro.html">
   Juniper Documentation
  </a>
 </li>
</ul>
<ul class="current nav bd-sidenav">
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../datasets/01_overview.html">
   Datasets
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-1" name="toctree-checkbox-1" type="checkbox"/>
  <label for="toctree-checkbox-1">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../datasets/gtfs_schedule.html">
     GTFS Schedule
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../datasets/mst_payments.html">
     MST Payments
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../datasets/transitstacks.html">
     Transitstacks
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../datasets/views.html">
     Views
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 current active">
  <a class="current reference internal" href="#">
   Kubernetes
  </a>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../services/overview.html">
   Services
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-2" name="toctree-checkbox-2" type="checkbox"/>
  <label for="toctree-checkbox-2">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../services/gtfs-ckan-uploader.html">
     GTFS CKAN Uploader
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../services/gtfs-rt-archive.html">
     gtfs-rt-archive
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../warehouse/overview.html">
   Warehouse
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-3" name="toctree-checkbox-3" type="checkbox"/>
  <label for="toctree-checkbox-3">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../warehouse/01_agencies.html">
     Agency GTFS Feeds
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../warehouse/02_views.html">
     Creating New Tables (Views)
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../warehouse/03_metrics.html">
     Metric Views
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../warehouse/04_sql_snippets.html">
     SQL Snippets
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../warehouse/05_using_metabase.html">
     Using Metabase
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../warehouse/06_table_names.html">
     Table names
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../warehouse/jupyterhub.html">
     Using Jupyterhub
    </a>
   </li>
   <li class="toctree-l2">
    <a class="reference internal" href="../warehouse/07_tutorial.html">
     Tutorial - Querying the CALITP Data Warehouse
    </a>
   </li>
  </ul>
 </li>
 <li class="toctree-l1 has-children">
  <a class="reference internal" href="../contributing/overview.html">
   Contribute
  </a>
  <input class="toctree-checkbox" id="toctree-checkbox-4" name="toctree-checkbox-4" type="checkbox"/>
  <label for="toctree-checkbox-4">
   <i class="fas fa-chevron-down">
   </i>
  </label>
  <ul>
   <li class="toctree-l2">
    <a class="reference internal" href="../contributing/editing_doc.html">
     Editing Documentation
    </a>
   </li>
  </ul>
 </li>
</ul>

    </div>
</nav> <!-- To handle the deprecated key -->

<div class="navbar_extra_footer">
  Powered by <a href="https://jupyterbook.org">Jupyter Book</a>
</div>

</div>


          


          
<main class="col py-md-3 pl-md-4 bd-content overflow-auto" role="main">
    
    <div class="topbar container-xl fixed-top">
    <div class="topbar-contents row">
        <div class="col-12 col-md-3 bd-topbar-whitespace site-navigation show"></div>
        <div class="col pl-md-4 topbar-main">
            
            <button id="navbar-toggler" class="navbar-toggler ml-0" type="button" data-toggle="collapse"
                data-toggle="tooltip" data-placement="bottom" data-target=".site-navigation" aria-controls="navbar-menu"
                aria-expanded="true" aria-label="Toggle navigation" aria-controls="site-navigation"
                title="Toggle navigation" data-toggle="tooltip" data-placement="left">
                <i class="fas fa-bars"></i>
                <i class="fas fa-arrow-left"></i>
                <i class="fas fa-arrow-up"></i>
            </button>
            
            
<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn" aria-label="Download this page"><i
            class="fas fa-download"></i></button>

    <div class="dropdown-buttons">
        <!-- ipynb file if we had a myst markdown file -->
        <a class="dropdown-buttons"
            href="../_sources/kubernetes/README.ipynb"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download notebook file" data-toggle="tooltip"
                data-placement="left">.ipynb</button></a>
        <!-- Download raw file -->
        <a class="dropdown-buttons" href="../_sources/kubernetes/README.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Download source file" data-toggle="tooltip"
                data-placement="left">.md</button></a>
        <!-- Download PDF via print -->
        <button type="button" id="download-print" class="btn btn-secondary topbarbtn" title="Print to PDF"
            onClick="window.print()" data-toggle="tooltip" data-placement="left">.pdf</button>
    </div>
</div>

            <!-- Source interaction buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Connect with source repository"><i class="fab fa-github"></i></button>
    <div class="dropdown-buttons sourcebuttons">
        <a class="repository-button"
            href="https://github.com/cal-itp/data-infra/"><button type="button" class="btn btn-secondary topbarbtn"
                data-toggle="tooltip" data-placement="left" title="Source repository"><i
                    class="fab fa-github"></i>repository</button></a>
        <a class="issues-button"
            href="https://github.com/cal-itp/data-infra//issues/new?title=Issue%20on%20page%20%2Fkubernetes/README.html&body=Your%20issue%20content%20here."><button
                type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip" data-placement="left"
                title="Open an issue"><i class="fas fa-lightbulb"></i>open issue</button></a>
        
    </div>
</div>

            <!-- Full screen (wrap in <a> to have style consistency -->

<a class="full-screen-button"><button type="button" class="btn btn-secondary topbarbtn" data-toggle="tooltip"
        data-placement="bottom" onclick="toggleFullScreen()" aria-label="Fullscreen mode"
        title="Fullscreen mode"><i
            class="fas fa-expand"></i></button></a>

            <!-- Launch buttons -->

<div class="dropdown-buttons-trigger">
    <button id="dropdown-buttons-trigger" class="btn btn-secondary topbarbtn"
        aria-label="Launch interactive content"><i class="fas fa-rocket"></i></button>
    <div class="dropdown-buttons">
        
        <a class="binder-button" href="https://mybinder.org/v2/gh/cal-itp/data-infra/master?urlpath=tree/docs/kubernetes/README.md"><button type="button"
                class="btn btn-secondary topbarbtn" title="Launch Binder" data-toggle="tooltip"
                data-placement="left"><img class="binder-button-logo"
                    src="../_static/images/logo_binder.svg"
                    alt="Interact on binder">Binder</button></a>
        
        
        
        
    </div>
</div>

        </div>

        <!-- Table of contents -->
        <div class="d-none d-md-block col-md-2 bd-toc show">
            
            <div class="tocsection onthispage pt-5 pb-3">
                <i class="fas fa-list"></i> Contents
            </div>
            <nav id="bd-toc-nav" aria-label="Page">
                <ul class="visible nav section-nav flex-column">
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#cluster-administration">
   Cluster Administration
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#preflight">
     preflight
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#quick-start">
     quick start
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#cluster-lifecycle">
     cluster lifecycle
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#nodepool-lifecycle">
     nodepool lifecycle
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#create-a-new-node-pool">
       create a new node pool
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#drain-and-delete-an-old-node-pool">
       drain and delete an old node pool
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
 <li class="toc-h2 nav-item toc-entry">
  <a class="reference internal nav-link" href="#deploy-cluster-workloads">
   Deploy Cluster Workloads
  </a>
  <ul class="nav section-nav flex-column">
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#system-workloads">
     system workloads
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#app-metabase">
     app: metabase
    </a>
   </li>
   <li class="toc-h3 nav-item toc-entry">
    <a class="reference internal nav-link" href="#app-gtfs-rt-archive">
     app: gtfs-rt-archive
    </a>
    <ul class="nav section-nav flex-column">
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#new-service-versions">
       new service versions
      </a>
     </li>
     <li class="toc-h4 nav-item toc-entry">
      <a class="reference internal nav-link" href="#agencies-data">
       agencies data
      </a>
     </li>
    </ul>
   </li>
  </ul>
 </li>
</ul>

            </nav>
        </div>
    </div>
</div>
    <div id="main-content" class="row">
        <div class="col-12 col-md-9 pl-md-3 pr-md-0">
        
              <div>
                
  <div class="tex2jax_ignore mathjax_ignore section" id="kubernetes">
<h1>Kubernetes<a class="headerlink" href="#kubernetes" title="Permalink to this headline">¶</a></h1>
<div class="section" id="cluster-administration">
<h2>Cluster Administration<a class="headerlink" href="#cluster-administration" title="Permalink to this headline">¶</a></h2>
<div class="section" id="preflight">
<h3>preflight<a class="headerlink" href="#preflight" title="Permalink to this headline">¶</a></h3>
<p>Check logged in user</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud auth list
<span class="c1"># ensure correct active user</span>
<span class="c1"># gcloud auth login</span>
</pre></div>
</div>
<p>Check active project</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud config get-value project
<span class="c1"># project should be cal-itp-data-infra</span>
<span class="c1"># gcloud config set project cal-itp-data-infra</span>
</pre></div>
</div>
<p>Check compute region</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>gcloud config get-value compute/region
<span class="c1"># region should be us-west1</span>
<span class="c1"># gcloud config set compute/region us-west1</span>
</pre></div>
</div>
</div>
<div class="section" id="quick-start">
<h3>quick start<a class="headerlink" href="#quick-start" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>./kubernetes/gke/cluster-create.sh
<span class="c1"># ...</span>
<span class="nb">export</span> <span class="nv">KUBECONFIG</span><span class="o">=</span><span class="nv">$PWD</span>/kubernetes/gke/kube/admin.yaml
kubectl cluster-info
</pre></div>
</div>
</div>
<div class="section" id="cluster-lifecycle">
<h3>cluster lifecycle<a class="headerlink" href="#cluster-lifecycle" title="Permalink to this headline">¶</a></h3>
<p>Create the cluster by running <code class="docutils literal notranslate"><span class="pre">kubernetes/gke/cluster-create.sh</span></code>.</p>
<p>The cluster level configuration parameters are stored in
<span class="xref myst"><code class="docutils literal notranslate"><span class="pre">kubernetes/gke/config-cluster.sh</span></code></span>.
Creating the cluster also requires configuring parameters for a node pool
named “default-pool” (unconfigurable name defined by GKE) in
<span class="xref myst"><code class="docutils literal notranslate"><span class="pre">kubernetes/gke/config-nodepool.sh</span></code></span>.
Any additional node pools configured in this file are also stood up at cluster
creation time.</p>
<p>Once the cluster is created, it can be managed by pointing the <code class="docutils literal notranslate"><span class="pre">KUBECONFIG</span></code>
environment variable to <code class="docutils literal notranslate"><span class="pre">kubernetes/gke/kube/admin.yaml</span></code>.</p>
<p>The cluster can be deleted by running <code class="docutils literal notranslate"><span class="pre">kubernetes/gke/cluster-delete.sh</span></code>.</p>
</div>
<div class="section" id="nodepool-lifecycle">
<h3>nodepool lifecycle<a class="headerlink" href="#nodepool-lifecycle" title="Permalink to this headline">¶</a></h3>
<p>Certain features of node pools are immutable (e.g., machine type); to change
such parameters requires creating a new node pool with the desired new values,
migrating workloads off of the old node pool, and then deleting the old node pool.
The node pool lifecycle scripts help simplify this process.</p>
<div class="section" id="create-a-new-node-pool">
<h4>create a new node pool<a class="headerlink" href="#create-a-new-node-pool" title="Permalink to this headline">¶</a></h4>
<p>Configure a new node pool by adding its name to the <code class="docutils literal notranslate"><span class="pre">GKE_NODEPOOL_NAMES</span></code> array
in <span class="xref myst"><code class="docutils literal notranslate"><span class="pre">kubernetes/gke/config-nodepool.sh</span></code></span>.
For each nodepool property (<code class="docutils literal notranslate"><span class="pre">GKE_NODEPOOL_NODE_COUNT</span></code>, <code class="docutils literal notranslate"><span class="pre">GKE_NODEPOOL_NODE_LOCATIONS</span></code>, etc)
it is required to add an entry to the array which is mapped to the nodepool name.</p>
<p>Once the new nodepool is configured, it can be stood up by running <code class="docutils literal notranslate"><span class="pre">kubernetes/gke/nodepool-up.sh</span> <span class="pre">[nodepool-name]</span></code>,
or by simply running <code class="docutils literal notranslate"><span class="pre">kubernetes/gke/nodepool-up.sh</span></code>, which will stand up all configured node pools which do not yet
exist.</p>
</div>
<div class="section" id="drain-and-delete-an-old-node-pool">
<h4>drain and delete an old node pool<a class="headerlink" href="#drain-and-delete-an-old-node-pool" title="Permalink to this headline">¶</a></h4>
<p>Once a new nodepool has been created to replace an active node pool, the old node pool must be
removed from the <code class="docutils literal notranslate"><span class="pre">GKE_NODEPOOL_NAMES</span></code> array.</p>
<p>Once the old node pool is removed from the array, it can be drained and deleted by running <code class="docutils literal notranslate"><span class="pre">kubernetes/gke/nodepool-down.sh</span> <span class="pre">&lt;nodepool-name&gt;</span></code>.</p>
</div>
</div>
</div>
<div class="section" id="deploy-cluster-workloads">
<h2>Deploy Cluster Workloads<a class="headerlink" href="#deploy-cluster-workloads" title="Permalink to this headline">¶</a></h2>
<p>Cluster workloads are divided into two classes:</p>
<ol class="simple">
<li><p>system</p></li>
<li><p>apps</p></li>
</ol>
<p>Apps are the workloads that users actually care about.</p>
<div class="section" id="system-workloads">
<h3>system workloads<a class="headerlink" href="#system-workloads" title="Permalink to this headline">¶</a></h3>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl apply -k kubernetes/system
</pre></div>
</div>
<p>System workloads are used to support running applications. This includes items
such as an ingress controller, monitoring, logging, etc. The system deploy command
is run at cluster create time, but when new system workloads are added it may need
to be run again.</p>
</div>
<div class="section" id="app-metabase">
<h3>app: metabase<a class="headerlink" href="#app-metabase" title="Permalink to this headline">¶</a></h3>
<p>First deploy:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm install metabase kubernetes/apps/charts/metabase -f kubernetes/apps/values/metabase.yaml -n metabase --create-namespace
</pre></div>
</div>
<p>Apply changes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>helm upgrade metabase kubernetes/apps/charts/metabase -f kubernetes/apps/values/metabase.yaml -n metabase
</pre></div>
</div>
</div>
<div class="section" id="app-gtfs-rt-archive">
<h3>app: gtfs-rt-archive<a class="headerlink" href="#app-gtfs-rt-archive" title="Permalink to this headline">¶</a></h3>
<p>First deploy:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span><span class="c1"># Archive url: https://bitwarden.jarv.us//attachments/1ef9cad1-40a3-41f2-963d-f43d64c06efb/09dd10cd528b5f9743f3</span>
tar xzvf kubernetes-secrets.tar.gz <span class="o">&amp;&amp;</span> rm kubernetes-secrets.tar.gz

<span class="c1"># Deploy app</span>
kubectl apply -k kubernetes/secrets
kubectl apply -k kubernetes/apps/overlays/gtfs-rt-<span class="si">${</span><span class="nv">environment</span><span class="si">}</span>
</pre></div>
</div>
<p>Apply changes:</p>
<div class="highlight-bash notranslate"><div class="highlight"><pre><span></span>kubectl apply -k kubernetes/apps/overlays/gtfs-rt-<span class="si">${</span><span class="nv">environment</span><span class="si">}</span>
</pre></div>
</div>
<div class="section" id="new-service-versions">
<h4>new service versions<a class="headerlink" href="#new-service-versions" title="Permalink to this headline">¶</a></h4>
<p>In order to deploy a new version of the service script, a container image of the new version needs to
be built and pushed to the GCR repository (see the <a class="reference internal" href="../services/gtfs-rt-archive.html"><span class="doc std std-doc">service documentation</span></a>
for details). Once there, the image version must be changed in <code class="docutils literal notranslate"><span class="pre">kubernetes/apps/overlays/gtfs-rt-${environmnt}/kustomization.yaml</span></code>
and the manifest change must then be applied (see: “Apply changes” above).</p>
</div>
<div class="section" id="agencies-data">
<h4>agencies data<a class="headerlink" href="#agencies-data" title="Permalink to this headline">¶</a></h4>
<p>The secret in <code class="docutils literal notranslate"><span class="pre">kubernetes/secrets/agencies-data.yaml</span></code> is a complete base64 encoded version
of the rendered agencies.yml file. When there are changes to the agencies file, the following
steps are required:</p>
<ol class="simple">
<li><p>Update the base64 data in <code class="docutils literal notranslate"><span class="pre">kubernetes/secrets/agencies-data.yaml</span></code> to contain the new agencies.yml contents</p></li>
<li><p>Upload the new data to the kubernetes API server</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">apply</span> <span class="pre">-f</span> <span class="pre">kubernetes/secrets/agencies-data.yaml</span></code></p></li>
</ul>
</li>
<li><p>Restart the kubernetes deployment</p>
<ul class="simple">
<li><p><code class="docutils literal notranslate"><span class="pre">kubectl</span> <span class="pre">-n</span> <span class="pre">gtfs-rt</span> <span class="pre">rollout</span> <span class="pre">restart</span> <span class="pre">deployment/gtfs-rt-archive</span></code></p></li>
</ul>
</li>
</ol>
<p>See the <a class="reference internal" href="../services/gtfs-rt-archive.html"><span class="doc std std-doc">gtfs-rt-archive service documentation</span></a> for details on downloading the
latest agencies file</p>
</div>
</div>
</div>
</div>

    <script type="text/x-thebe-config">
    {
        requestKernel: true,
        binderOptions: {
            repo: "binder-examples/jupyter-stacks-datascience",
            ref: "master",
        },
        codeMirrorConfig: {
            theme: "abcdef",
            mode: "python"
        },
        kernelOptions: {
            kernelName: "python3",
            path: "./kubernetes"
        },
        predefinedOutput: true
    }
    </script>
    <script>kernelName = 'python3'</script>

              </div>
              
        
            



<div class='prev-next-bottom'>
    
    <div id="prev">
        <a class="left-prev" href="../datasets/views.html" title="previous page">
            <i class="prevnext-label fas fa-angle-left"></i>
            <div class="prevnext-info">
                <p class="prevnext-label">previous</p>
                <p class="prevnext-title">Views</p>
            </div>
        </a>
    </div>
     <div id="next">
        <a class="right-next" href="../services/overview.html" title="next page">
            <div class="prevnext-info">
                <p class="prevnext-label">next</p>
                <p class="prevnext-title">Services</p>
            </div>
            <i class="prevnext-label fas fa-angle-right"></i>
        </a>
     </div>

</div>
        
        </div>
    </div>
    <footer class="footer">
    <div class="container">
      <p>
        
          By Jarv.us<br/>
        
            &copy; Copyright 2021.<br/>
      </p>
    </div>
  </footer>
</main>


      </div>
    </div>
  
  <script src="../_static/js/index.1c5a1a01449ed65a7b51.js"></script>

  
  </body>
</html>